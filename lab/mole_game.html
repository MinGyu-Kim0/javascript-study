<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Whack-a-Mole</title>
    <style>
      .board {
        display: grid;
        grid-template-columns: repeat(3, 100px);
        gap: 10px;
        margin-bottom: 10px;
      }
      .cell {
        width: 100px;
        height: 100px;
        background: #ddd;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 40px;
        cursor: pointer;
      }
      .mole {
        background: gold;
      }
    </style>
  </head>
  <body>
    <h2>ë‘ë”ì§€ ì¡ê¸° ê²Œì„</h2>
    <div>ì ìˆ˜: <span id="score">0</span></div>
    <button id="startBtn">ê²Œì„ ì‹œì‘</button>

    <div class="board" id="board"></div>

    <script>
      const board = document.getElementById("board");
      const scoreEl = document.getElementById("score");
      const startBtn = document.getElementById("startBtn");

      let score = 0;
      let timer = null;
      let currentIndex = -1;
      let cells = [];

      // 1. ë³´ë“œ ìƒì„± (DOM Create)
      /*
             [ë¬¸ì œ 1]
             â€» íŒíŠ¸:
             - document.createElement("div")
             - div.className = "cell"
             - div.dataset.index = i
             - board.appendChild(div)
             */
      function createBoard() {
        // 9ê°œì˜ ì…€(div)ì„ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ì—¬ boardì— ì¶”ê°€í•œë‹¤.
        for (let i = 0; i < 9; i++) {
          let div = document.createElement("div");

          // ê° ì…€ì— classNameìœ¼ë¡œ "cell"ì„ ì§€ì •í•œë‹¤.
          div.className = "cell";

          // ê° ì…€ì— dataset.indexë¡œ 0~8ê¹Œì§€ì˜ ì¸ë±ìŠ¤ë¥¼ ì €ì¥í•œë‹¤.
          div.dataset.index = i;

          // board.appendChild()ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±í•œ divë¥¼ boardì— ì¶”ê°€í•œë‹¤.
          board.appendChild(div);

          // cells ë°°ì—´ì— ë„£ê¸°
          cells.push(div);
        }
      }

      // 2. ëœë¤ ë‘ë”ì§€ ë“±ì¥
      /*
             [ë¬¸ì œ 2]
             â€» íŒíŠ¸:
             - cells.forEach()ë¡œ ëª¨ë“  ì…€ ìˆœíšŒ
             - c.classList.remove("mole"), c.textContent = ""
             - Math.floor(Math.random() * cells.length)
             - cells[rand].classList.add("mole")
             - cells[rand].textContent = "ğŸ¹"
             */
      function showMole() {
        // ëª¨ë“  ì…€ì—ì„œ ë‘ë”ì§€ë¥¼ ì œê±°í•œë‹¤ (mole í´ë˜ìŠ¤ ì œê±°, í…ìŠ¤íŠ¸ ë¹„ìš°ê¸°).
        cells.forEach(function (c) {
          c.classList.remove("mole");
          c.textContent = "";
        });

        // 0 ~ 8 ì‚¬ì´ì˜ ëœë¤í•œ ìˆ«ìë¥¼ ìƒì„±í•œë‹¤.
        let rand = Math.floor(Math.random() * cells.length);
        // currentIndex ë³€ìˆ˜ì— í˜„ì¬ ë‘ë”ì§€ ìœ„ì¹˜ë¥¼ ì €ì¥í•œë‹¤.
        currentIndex = rand;

        // ëœë¤í•˜ê²Œ ì„ íƒëœ ì…€ì— "mole" í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ê³ , ğŸ¹ ì´ëª¨ì§€ë¥¼ í‘œì‹œí•œë‹¤.
        cells[rand].classList.add("mole");
        cells[rand].textContent = "ğŸ¹";
      }
      // 3. í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬
      /*
             [ë¬¸ì œ 3]
             â€» íŒíŠ¸:
             - cells.forEach(cell => { ... })
             - cell.addEventListener("click", () => { ... })
             - Number(cell.dataset.index) === currentIndex
             - score++
             - scoreEl.textContent = score
             */
      // ëª¨ë“  ì…€ì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•œë‹¤. forEach, addEventListener
      function addClickEvents() {
        cells.forEach(function (cell) {
          cell.addEventListener("click", function () {
            // í´ë¦­í•œ ì…€ì˜ ì¸ë±ìŠ¤(dataset.index)ì™€ currentIndexë¥¼ ë¹„êµí•œë‹¤.
            // ë‘ë”ì§€ê°€ ìˆëŠ” ì…€ì„ í´ë¦­í–ˆë‹¤ë©´ scoreë¥¼ 1 ì¦ê°€ì‹œí‚¨ë‹¤.
            if (Number(cell.dataset.index) === currentIndex) {
              score++;
              // ë³€ê²½ëœ ì ìˆ˜ë¥¼ scoreElì— í‘œì‹œí•œë‹¤.
              scoreEl.textContent = score;

              // ë‘ë”ì§€ ìˆëŠ” ì…€ì„ ëˆŒë €ì„ë•Œ í•´ë‹¹ ì…€ ì§€ìš°ê¸°.
              cell.classList.remove("mole");
              cell.textContent = "";
              // ì¤‘ë³µ ì ìˆ˜ íšë“ì„ ë§‰ê¸° ìœ„í•´ ì¸ë±ìŠ¤ ê°’ ì´ˆê¸°í™”.
              currentIndex = -1;
            }
          });
        });
      }
      // 4. ê²Œì„ ì‹œì‘ ë²„íŠ¼
      /*
             [ë¬¸ì œ 4]
             â€» íŒíŠ¸:
             - startBtn.addEventListener("click", () => { ... })
             - if (timer) return;
             - timer = setInterval(showMole, 800)
             - setTimeout(() => { ... }, 10000)
             - clearInterval(timer)
             - alert("ê²Œì„ ì¢…ë£Œ! ì ìˆ˜: " + score)
             */
      // ì‹œì‘ ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•œë‹¤.
      startBtn.addEventListener("click", function () {
        // ì´ë¯¸ ê²Œì„ì´ ì§„í–‰ ì¤‘ì´ë©´(timerê°€ ìˆìœ¼ë©´) í•¨ìˆ˜ë¥¼ ì¢…ë£Œí•œë‹¤.
        if (timer) return;
        alert("ê²Œì„ ì‹œì‘!");

        // ê²Œì„ ì‹œì‘ ì‹œ scoreë¥¼ 0ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ê³  í™”ë©´ì— í‘œì‹œí•œë‹¤.
        score = 0;
        scoreEl.textContent = score;
        // setInterval()ì„ ì‚¬ìš©í•˜ì—¬ 0.8ì´ˆë§ˆë‹¤ showMole() í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.
        timer = setInterval(showMole, 800);
        // setTimeout()ì„ ì‚¬ìš©í•˜ì—¬ 10ì´ˆ í›„ ê²Œì„ì„ ì¢…ë£Œí•œë‹¤.
        setTimeout(() => {
          // ê²Œì„ ì¢…ë£Œ ì‹œ: clearInterval()ë¡œ íƒ€ì´ë¨¸ ì¤‘ì§€, timerë¥¼ nullë¡œ ì´ˆê¸°í™”
          clearInterval(timer);
          timer = null;
          // alert()ë¡œ ìµœì¢… ì ìˆ˜ë¥¼ í‘œì‹œí•œë‹¤.
          alert("ê²Œì„ ì¢…ë£Œ! ì ìˆ˜: " + score);
        }, 10000);
      });
      createBoard();
      addClickEvents();
    </script>
  </body>
</html>
